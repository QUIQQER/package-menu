<nav>
    <ul class="quiqqer-menu-megaMenu-list">
        {if $this->getAttribute('showStart')}
        <li class="quiqqer-menu-megaMenu-list-item{if $Site->getId() == $Start->getId()} quiqqer-menu-megaMenu-list-item--current{/if}">
            <a href="{url site=$Start}" title="{$Start->getAttribute('title')|escape:" html"}">
            {$Start->getAttribute('title')}
            </a>
        </li>
        {/if}

        {foreach $children as $Child}
            {assign var=isInPath value=0}
            {if $Child->getId() == $Site->getId() ||
                $Rewrite->isIdInPath($Child->getId())
            }
                {assign var=isInPath value=1}
            {/if}
        <li class="quiqqer-menu-megaMenu-list-item{if $isInPath} quiqqer-menu-megaMenu-list-item--current{/if}">
            <a href="{url site=$Child}" title="{$Child->getAttribute('title')|escape:"html"}">
                {$Child->getAttribute('title')}
            </a>

            {assign var=subchildren value=$Child->getNavigation()}
            {if count($subchildren)}
            <div class="quiqqer-menu-megaMenu-list-item-menu">
                <div class="quiqqer-menu-megaMenu-list-item-menu-children">
                    <ul class="quiqqer-menu-megaMenu-list-item-menu-children-list">
                        {foreach $subchildren as $SubChild}
                        <li class="quiqqer-menu-megaMenu-list-item-menu-children-list-entry">
                            <a href="{url site=$SubChild}"
                               title="{$SubChild->getAttribute('title')|escape:"html"}">
                            {$SubChild->getAttribute('title')}
                            </a>

                            {assign var=subsubchildren value=$SubChild->getNavigation()}

                            {if count($subsubchildren)}
                            <div class="quiqqer-menu-megaMenu-list-item-menu-children-list-entry-short">
                            <ul>
                                {foreach $subsubchildren as $SubSubChild}
                                <li>
                                    <a href="{url site=$SubSubChild}"
                                       title="{$SubSubChild->getAttribute('title')|escape:"html"}">
                                    {$SubSubChild->getAttribute('title')}
                                    </a>
                                </li>
                                {/foreach}
                            </ul>
                            </div>
                            {else}
                                {if $SubChild->getAttribute('short')}
                                <div class="quiqqer-menu-megaMenu-list-item-menu-children-list-entry-short">
                                    {$SubChild->getAttribute('short')}
                                </div>
                                {/if}
                            {/if}
                        </li>
                        {/foreach}
                    </ul>
                </div>
                <div class="quiqqer-menu-megaMenu-list-item-menu-icon">
                    {image src=$Child->getAttribute('image_site') width=200}
                </div>
            </div>
            {/if}
        </li>
        {/foreach}
    </ul>
</nav>